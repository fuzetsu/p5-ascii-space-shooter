var S=Object.defineProperty;var V=(r,e,t)=>e in r?S(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var s=(r,e,t)=>V(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const n of h.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function i(o){if(o.ep)return;o.ep=!0;const h=t(o);fetch(o.href,h)}})();const u=()=>Math.min(700,windowWidth-20),c=()=>Math.min(u()*1.7,windowHeight-20);class b{constructor(e,t,i=10){s(this,"pos");s(this,"speed");s(this,"char");s(this,"visible",!0);this.pos=new p5.Vector(e,t),this.speed=i,this.char="|"}draw(){fill(255),text(this.char,this.pos.x,this.pos.y)}move(){this.pos.sub(0,this.speed),this.visible=this.pos.y>0&&this.pos.y<c()+20}}const x=5;class y{constructor(){s(this,"pos");s(this,"speed");s(this,"char");s(this,"width");s(this,"height");s(this,"visible",!0);s(this,"lastShot",0);s(this,"health",x);s(this,"alive",!0);s(this,"damagePos",[]);this.speed=1,this.char=`  /\\
 /  \\
/____\\
\\    /
 \\  /
  \\/`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(random(5,u()-this.width),0)}draw(){var t;push(),fill(255),text(this.char,this.pos.x,this.pos.y),Date.now()-this.lastShot<1e3&&(fill(255,255,0),text(`
\\    /`,this.pos.x,this.pos.y),ellipse(this.pos.x+this.width/2,this.pos.y+this.height/2,5));let e=x-this.health;for(fill(255,0,0);--e>=0;)(t=this.damagePos)[e]??(t[e]=new p5.Vector(random(this.width-this.width*.3),random(this.height-this.height*.3))),ellipse(this.pos.x+this.width*(.3/2)+this.damagePos[e].x,this.pos.y+this.height*(.3/2)+this.damagePos[e].y,5);pop()}takeDamage(e){this.health-=e,this.alive=this.health>0}move(e){this.pos.add(0,this.speed),this.visible=this.pos.y<c()+20,Math.floor(random(100))===25&&(this.lastShot=Date.now(),e.push(new b(this.pos.x-4+this.width/2,this.pos.y+this.height,-6)))}}class v{constructor(e,t){s(this,"pos");s(this,"timer");s(this,"char");s(this,"finished",!1);this.pos=new p5.Vector(e,t),this.timer=30,this.char=`'.\\|/.'
(\\   /)
- -O- -
(/   \\)
.'/|\\'.`}draw(){push(),fill(255,0,0),translate(this.pos),textAlign("center","center"),text(this.char,0,0),pop()}move(){this.timer-=1,this.finished=this.timer<=0}}class L{constructor(){s(this,"char");s(this,"width");s(this,"height");s(this,"pos");s(this,"lastShot",0);this.char=`   /\\
  (  )
  (  )
 /|/\\|\\
/_||||_\\`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(u()/2-this.width/2,c()-80)}draw(){fill(255),text(this.char,this.pos.x,this.pos.y)}move(e){const t=keyIsDown(32)||mouseIsPressed;t&&Date.now()-this.lastShot>200&&(this.lastShot=Date.now(),e.push(new b(this.pos.x+-4+this.width/2,this.pos.y-12)));const i=createVector(mouseX,mouseY),o=createVector(this.width/2,this.height/2).add(this.pos),h=i.dist(o);if(h>5){const n=createVector(mouseX,mouseY).sub(o);h<this.height*2?n.mult(.05):(n.normalize(),n.mult(t?4:7)),this.pos.x=constrain(this.pos.x+n.x,10,u()-this.width),this.pos.y=constrain(this.pos.y+n.y,10,c()-this.height)}}}let p=null,a=[],f=[],d=[],l=-1,g=0,w=120;window.setup=()=>{createCanvas(u(),c())};window.windowResized=()=>{resizeCanvas(u(),c())};window.draw=()=>{if(textFont("menlo"),textAlign("left"),background(0),textSize(13),l===0){textAlign("center"),textSize(50),fill(255),text(g+` points
GAME OVER
Press Space`,u()/2,c()/2),(keyIsDown(32)||mouseIsPressed)&&(p=null,l=-1);return}l!==-1&&(l-=1),p||(p=new L,a=[],f=[],d=[],g=0,w=120),(l===-1||l>20)&&p.draw(),l===-1&&p.move(d),l===-1&&frameCount%w===0&&(w>80&&random(10)<2&&(console.log("increasing spawnRate",w),w-=20),a.push(new y));for(let t of a)t.draw(),t.move(d);a=a.filter(t=>t.visible);for(let t of d)t.draw(),t.move();const r=[p,...a];for(let t of d)for(let i of r){const o=i.pos.x+i.width*.2,h=o+i.width*.6,n=i.pos.y,P=i.pos.y+i.height;if(t.pos.x>=o&&t.pos.x<=h&&t.pos.y>=n&&t.pos.y<=P){t.visible=!1;const m=new p5.Vector(i.pos.x+i.width/2,i.pos.y+i.height/2);i===p?(l===-1&&(l=50),f.push(new v(m.x,m.y))):i instanceof y&&(i.takeDamage(2.5),i.alive||(f.push(new v(m.x,m.y)),g+=1,a=a.filter(O=>O!==i)))}}d=d.filter(t=>t.visible);for(let t of f)t.draw(),t.move();f=f.filter(t=>!t.finished);const e=1+d.length+f.length+a.length;text("entities "+e,3,c()-5),text("score "+g,3,c()-5-textLeading())};
