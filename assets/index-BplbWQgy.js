var A=Object.defineProperty;var C=(o,e,t)=>e in o?A(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var i=(o,e,t)=>C(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const r of h)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(h){const r={};return h.integrity&&(r.integrity=h.integrity),h.referrerPolicy&&(r.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?r.credentials="include":h.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(h){if(h.ep)return;h.ep=!0;const r=t(h);fetch(h.href,r)}})();const p=()=>Math.min(700,windowWidth-20),a=()=>Math.min(p()*1.7,windowHeight-20),P=(o,e)=>!(o.x>e.x+e.width||e.x>o.x+o.width||o.y>e.y+e.height||e.y>o.y+o.height);class L{constructor(e,t,s,h=10){i(this,"pos");i(this,"width");i(this,"height");i(this,"speed");i(this,"char");i(this,"visible",!0);i(this,"owner");this.owner=e,this.pos=new p5.Vector(t,s),this.speed=h,this.char="|",this.width=textWidth(this.char),this.height=textLeading()}draw(){fill(255),text(this.char,this.pos.x,this.pos.y)}move(){this.pos.sub(0,this.speed),this.visible=this.pos.y>0&&this.pos.y<a()+20}}const x=5;class v{constructor(){i(this,"pos");i(this,"speed");i(this,"char");i(this,"width");i(this,"height");i(this,"visible",!0);i(this,"lastShot",0);i(this,"health",x);i(this,"alive",!0);i(this,"damagePos",[]);this.speed=1,this.char=`  /\\
 /  \\
/____\\
\\    /
 \\  /
  \\/`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(random(5,p()-this.width),0)}draw(){var t;push(),fill(255),text(this.char,this.pos.x,this.pos.y),Date.now()-this.lastShot<1e3&&(fill(255,255,0),text(`
\\    /`,this.pos.x,this.pos.y),ellipse(this.pos.x+this.width/2,this.pos.y+this.height/2,5));let e=x-this.health;for(fill(255,0,0);--e>=0;)(t=this.damagePos)[e]??(t[e]=new p5.Vector(random(this.width-this.width*.3),random(this.height-this.height*.3))),ellipse(this.pos.x+this.width*(.3/2)+this.damagePos[e].x,this.pos.y+this.height*(.3/2)+this.damagePos[e].y,5);pop()}takeDamage(e){this.health-=e,this.alive=this.health>0}move(e){this.pos.add(0,this.speed),this.visible=this.pos.y<a()+20,Math.floor(random(100))===25&&(this.lastShot=Date.now(),e.push(new L("enemy",this.pos.x-4+this.width/2,this.pos.y+this.height,-6)))}}class S{constructor(e,t){i(this,"pos");i(this,"timer");i(this,"char");i(this,"finished",!1);this.pos=new p5.Vector(e,t),this.timer=30,this.char=`'.\\|/.'
(\\   /)
- -O- -
(/   \\)
.'/|\\'.`}draw(){push(),fill(255,0,0),translate(this.pos),textAlign("center","center"),text(this.char,0,0),pop()}move(){this.timer-=1,this.finished=this.timer<=0}}class b{constructor(e=!1){i(this,"char");i(this,"width");i(this,"height");i(this,"pos");i(this,"lastShot",0);i(this,"startScreen",!1);this.char=`   /\\
  (  )
  (  )
 /|/\\|\\
/_||||_\\`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(p()/2-this.width/2,a()-80),this.startScreen=e}draw(){push(),stroke(255),fill(255),textAlign("left"),text(this.char,this.pos.x,this.pos.y),pop()}move(e){const t=mouseIsPressed||keyIsDown(32);t&&Date.now()-this.lastShot>200&&(this.lastShot=Date.now(),e.push(new L("player",this.pos.x+-4+this.width/2,this.pos.y-12)));const s=createVector(mouseX,mouseY),h=createVector(this.width/2,this.height/2).add(this.pos),r=s.dist(h);if(r>5){const d=t?4:7,n=createVector(mouseX,mouseY).sub(h);r<this.height*2?(n.mult(.05),n.x=min(n.x,d),n.y=min(n.y,d)):(n.normalize(),n.mult(d)),this.pos.x=constrain(this.pos.x+n.x,10,p()-this.width),this.startScreen||(this.pos.y=constrain(this.pos.y+n.y,10,a()-this.height))}}}class V{constructor(){i(this,"player");i(this,"bullets",[]);i(this,"started",!1);this.player=new b(!0)}draw(){push(),this.player.draw(),this.player.move(this.bullets);for(const h of this.bullets)h.draw(),h.move();fill(255),stroke(255),textSize(50),textAlign("center","center");const e=p()/2,t=a()/2;text("Space Shooter",e,t-textLeading());const s={x:e-100,y:t,width:200,height:textLeading()*1.2};P(s,{x:mouseX-2,y:mouseY-2,height:4,width:4})?(cursor("pointer"),mouseIsPressed&&(this.started=!0)):cursor("initial"),textSize(25),text("START",s.x,s.y,s.width,s.height),noFill(),rect(s.x,s.y,s.width,s.height),pop()}}let f=null,c=[],w=[],u=[],l=-1,m=0,g=120,y;window.setup=()=>{createCanvas(p(),a()),y=new V};window.windowResized=()=>{resizeCanvas(p(),a())};window.draw=()=>{if(textFont("menlo"),textAlign("left"),background(0),textSize(13),!y.started){y.draw();return}if(l===0){textAlign("center"),textSize(50),fill(255),text(m+` points
GAME OVER
Click to try again`,p()/2,a()/2),(keyIsDown(32)||mouseIsPressed)&&(f=null,y.started=!1,l=-1);return}l!==-1&&(l-=1),f||(f=new b,c=[],w=[],u=[],m=0,g=120),(l===-1||l>20)&&f.draw(),l===-1&&f.move(u),l===-1&&frameCount%g===0&&(g>80&&random(10)<2&&(console.log("increasing spawnRate",g),g-=20),c.push(new v));for(let t of c)t.draw(),t.move(u);c=c.filter(t=>t.visible);const o=[f,...c];for(let t of u){t.draw(),t.move();for(let s of o){const h=s===f;if(h&&t.owner==="player"||!h&&t.owner==="enemy")continue;const r=h?.15:0;if(P({x:t.pos.x,y:t.pos.y,height:t.height,width:t.width},{x:s.pos.x+s.width*r,y:s.pos.y,width:s.width*(1-r*2),height:s.height})){t.visible=!1;const n=new p5.Vector(s.pos.x+s.width/2,s.pos.y+s.height/2);if(h)l===-1&&(l=50),w.push(new S(n.x,n.y));else if(s instanceof v){const O=t.owner==="player"?2.5:1;s.takeDamage(O),s.alive||(w.push(new S(n.x,n.y)),m+=1)}}}}c=c.filter(t=>t.alive),u=u.filter(t=>t.visible);for(let t of w)t.draw(),t.move();w=w.filter(t=>!t.finished);const e=1+u.length+w.length+c.length;text("entities "+e,3,a()-5),text("score "+m,3,a()-5-textLeading())};
