var b=Object.defineProperty;var P=(r,e,t)=>e in r?b(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var i=(r,e,t)=>P(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const h of s)if(h.type==="childList")for(const n of h.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const h={};return s.integrity&&(h.integrity=s.integrity),s.referrerPolicy&&(h.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?h.credentials="include":s.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(s){if(s.ep)return;s.ep=!0;const h=t(s);fetch(s.href,h)}})();const w=800,p=1e3;class v{constructor(e,t,o=10){i(this,"pos");i(this,"speed");i(this,"char");i(this,"visible",!0);this.pos=new p5.Vector(e,t),this.speed=o,this.char="|"}draw(){fill(255),text(this.char,this.pos.x,this.pos.y)}move(){this.pos.sub(0,this.speed),this.visible=this.pos.y>0&&this.pos.y<p+20}}const g=5;class x{constructor(){i(this,"pos");i(this,"speed");i(this,"char");i(this,"width");i(this,"height");i(this,"visible",!0);i(this,"lastShot",0);i(this,"health",g);i(this,"alive",!0);i(this,"damagePos",[]);this.speed=1,this.char=`  /\\
 /  \\
/____\\
\\    /
 \\  /
  \\/`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(random(5,w-this.width),0)}draw(){var t;push(),fill(255),text(this.char,this.pos.x,this.pos.y),Date.now()-this.lastShot<1e3&&(fill(255,255,0),text(`
\\    /`,this.pos.x,this.pos.y),ellipse(this.pos.x+this.width/2,this.pos.y+this.height/2,5));let e=g-this.health;for(fill(255,0,0);--e>=0;)(t=this.damagePos)[e]??(t[e]=new p5.Vector(random(this.width-this.width*.3),random(this.height-this.height*.3))),ellipse(this.pos.x+this.width*(.3/2)+this.damagePos[e].x,this.pos.y+this.height*(.3/2)+this.damagePos[e].y,5);pop()}takeDamage(e){this.health-=e,this.alive=this.health>0}move(e){this.pos.add(0,this.speed),this.visible=this.pos.y<p+20,Math.floor(random(100))===25&&(this.lastShot=Date.now(),e.push(new v(this.pos.x-4+this.width/2,this.pos.y+this.height,-6)))}}class y{constructor(e,t){i(this,"pos");i(this,"timer");i(this,"char");i(this,"finished",!1);this.pos=new p5.Vector(e,t),this.timer=30,this.char=`'.\\|/.'
(\\   /)
- -O- -
(/   \\)
.'/|\\'.`}draw(){push(),fill(255,0,0),translate(this.pos),textAlign("center","center"),text(this.char,0,0),pop()}move(){this.timer-=1,this.finished=this.timer<=0}}class O{constructor(){i(this,"char");i(this,"width");i(this,"height");i(this,"pos");i(this,"lastShot",0);this.char=`   /\\
  (  )
  (  )
 /|/\\|\\
/_||||_\\`,this.width=textWidth(this.char),this.height=this.char.split(`
`).length*textLeading(),this.pos=new p5.Vector(w/2-this.width/2,p-80)}draw(){fill(255),text(this.char,this.pos.x,this.pos.y)}move(e){const t=keyIsDown(32)||mouseIsPressed;t&&Date.now()-this.lastShot>200&&(this.lastShot=Date.now(),e.push(new v(this.pos.x+-4+this.width/2,this.pos.y-12)));const o=createVector(mouseX,mouseY),s=createVector(this.width/2,this.height/2).add(this.pos),h=o.dist(s);if(h>5){const n=createVector(mouseX,mouseY).sub(s);h<this.height*2?n.mult(.05):(n.normalize(),n.mult(t?4:7)),this.pos.x=constrain(this.pos.x+n.x,10,w-this.width),this.pos.y=constrain(this.pos.y+n.y,10,p-this.height)}}}let d=null,a=[],f=[],c=[],l=-1,m=0,u=120;window.setup=()=>{createCanvas(w,p)};window.draw=()=>{if(textFont("menlo"),textAlign("left"),background(0),textSize(13),l===0){textAlign("center"),textSize(50),fill(255),text(m+` points
GAME OVER
Press Space`,w/2,p/2),(keyIsDown(32)||mouseIsPressed)&&(d=null,l=-1);return}l!==-1&&(l-=1),d||(d=new O,a=[],f=[],c=[],m=0,u=120),(l===-1||l>20)&&d.draw(),l===-1&&d.move(c),l===-1&&frameCount%u===0&&(u>80&&random(10)<2&&(console.log("increasing spawnRate",u),u-=20),a.push(new x));for(let t of a)t.draw(),t.move(c);a=a.filter(t=>t.visible);for(let t of c)t.draw(),t.move();const r=[d,...a];for(let t of c)for(let o of r){const s=new p5.Vector(o.pos.x+o.width/2,o.pos.y+o.height/2),h=o.width/2;s.dist(t.pos)<h&&(t.visible=!1,o===d?(l===-1&&(l=50),f.push(new y(s.x,s.y))):o instanceof x&&(o.takeDamage(2.5),o.alive||(f.push(new y(s.x,s.y)),m+=1,a=a.filter(n=>n!==o))))}c=c.filter(t=>t.visible);for(let t of f)t.draw(),t.move();f=f.filter(t=>!t.finished);const e=1+c.length+f.length+a.length;text("entities "+e,3,p-5),text("score "+m,3,p-5-textLeading())};
